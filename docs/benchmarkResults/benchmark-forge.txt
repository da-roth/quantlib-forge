
=============================================================
  Forge Benchmark - All Approaches
=============================================================
=============================================================
  XVA Benchmark - QuantLib with Forge (COMPREHENSIVE)
  All approaches: Bump-Reval, Forward-Only, AAD
  SSE2 vs AVX2, Stability vs AllOpt vs NoOpt
=============================================================

  CPU AVX2 Support: YES


Running Test 1: Simple (10 RF)...
  Bump-Reval (10 RF)...
  Forward-SSE2-Stab (10 RF)...
[Forge][Warning] AReal::value() called while Forge recording is active on an active value – this drops you out of the Forge graph (occurrence 1)
[Forge][Warning] AReal::value() called while Forge recording is active on an active value – this drops you out of the Forge graph (occurrence 2)
[Forge][Warning] AReal::value() called while Forge recording is active on an active value – this drops you out of the Forge graph (occurrence 3)
[Forge][Warning] AReal::value() called while Forge recording is active on an active value – this drops you out of the Forge graph (occurrence 4)
[Forge][Warning] AReal::value() called while Forge recording is active on an active value – this drops you out of the Forge graph (occurrence 5)
[Forge][Warning] AReal::value() called while Forge recording is active on an active value – this drops you out of the Forge graph (occurrence 6)
[Forge][Warning] AReal::value() called while Forge recording is active on an active value – this drops you out of the Forge graph (occurrence 7)
[Forge][Warning] AReal::value() called while Forge recording is active on an active value – this drops you out of the Forge graph (occurrence 8)
[Forge][Warning] AReal::value() called while Forge recording is active on an active value – this drops you out of the Forge graph (occurrence 9)
[Forge][Warning] AReal::value() called while Forge recording is active on an active value – this drops you out of the Forge graph (occurrence 10)
  Forward-SSE2-AllOpt (10 RF)...
  Forward-AVX2-Stab (10 RF)...
  Forward-AVX2-AllOpt (10 RF)...
  AAD-SSE2-Stab (10 RF)...
  AAD-SSE2-AllOpt (10 RF)...
  AAD-AVX2-Stab (10 RF)...
  AAD-AVX2-AllOpt (10 RF)...

+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Test 1: Simple (10 RF)                                                                                                                     |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Config: 1 swap, 1 step, 1 path, 10 RF                                                                                                      |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Method               |        Bump|       F-Fwd|   F-Fwd-Opt|   F-Fwd-AVX|F-Fwd-AVX-Opt|      AAD-S2|  AAD-S2-Opt|      AAD-A2|  AAD-A2-Opt|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Avg Time/Iter (ms)   |        0.44|        0.34|        0.78|        0.36|        0.81|        0.43|        0.83|        0.47|        0.87|
| Pure Eval (ms)       |        0.44|        0.00|        0.00|        0.01|        0.00|        0.00|        0.00|        0.00|        0.00|
| Kernel Create (ms)   |           -|        0.33|        0.78|        0.36|        0.81|        0.43|        0.83|        0.47|        0.86|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Speedup vs Bump      |       1.00x|       1.29x|       0.56x|       1.20x|       0.54x|       1.02x|       0.52x|       0.93x|       0.50x|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Expected Exposure    |  3.7407e+04|  3.7407e+04|  3.7407e+04|  3.7407e+04|  3.7407e+04|  3.7407e+04|  3.7407e+04|  3.7407e+04|  3.7407e+04|
| CVA                  |  2.9926e+02|  2.9926e+02|  2.9926e+02|  2.9926e+02|  2.9926e+02|  2.9926e+02|  2.9926e+02|  2.9926e+02|  2.9926e+02|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+


Running Test 2: Full RF (100 RF)...
  Bump-Reval (100 RF)...
  Forward-SSE2-Stab (100 RF)...
  Forward-SSE2-AllOpt (100 RF)...
  Forward-AVX2-Stab (100 RF)...
  Forward-AVX2-AllOpt (100 RF)...
  AAD-SSE2-Stab (100 RF)...
  AAD-SSE2-AllOpt (100 RF)...
  AAD-AVX2-Stab (100 RF)...
  AAD-AVX2-AllOpt (100 RF)...

+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Test 2: Full RF (100 RF)                                                                                                                   |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Config: 1 swap, 1 step, 1 path, 100 RF                                                                                                     |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Method               |        Bump|       F-Fwd|   F-Fwd-Opt|   F-Fwd-AVX|F-Fwd-AVX-Opt|      AAD-S2|  AAD-S2-Opt|      AAD-A2|  AAD-A2-Opt|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Avg Time/Iter (ms)   |        4.70|        0.49|        1.15|        0.58|        1.26|        0.60|        1.29|        0.68|        1.35|
| Pure Eval (ms)       |        4.70|        0.03|        0.02|        0.10|        0.05|        0.00|        0.00|        0.00|        0.00|
| Kernel Create (ms)   |           -|        0.45|        1.13|        0.48|        1.21|        0.59|        1.29|        0.68|        1.35|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Speedup vs Bump      |       1.00x|       9.67x|       4.07x|       8.08x|       3.74x|       7.86x|       3.63x|       6.87x|       3.47x|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Expected Exposure    |  4.1649e+04|  4.1649e+04|  4.1649e+04|  4.1649e+04|  4.1649e+04|  4.1649e+04|  4.1649e+04|  4.1649e+04|  4.1649e+04|
| CVA                  |  3.3319e+02|  3.3319e+02|  3.3319e+02|  3.3319e+02|  3.3319e+02|  3.3319e+02|  3.3319e+02|  3.3319e+02|  3.3319e+02|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+


Running Test 3: Time Steps (3 steps)...
  Bump-Reval (100 RF)...
  Forward-SSE2-Stab (100 RF)...
  Forward-SSE2-AllOpt (100 RF)...
  Forward-AVX2-Stab (100 RF)...
  Forward-AVX2-AllOpt (100 RF)...
  AAD-SSE2-Stab (100 RF)...
  AAD-SSE2-AllOpt (100 RF)...
  AAD-AVX2-Stab (100 RF)...
  AAD-AVX2-AllOpt (100 RF)...

+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Test 3: Time Steps (3 steps)                                                                                                               |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Config: 1 swap, 3 steps, 1 path, 100 RF                                                                                                    |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Method               |        Bump|       F-Fwd|   F-Fwd-Opt|   F-Fwd-AVX|F-Fwd-AVX-Opt|      AAD-S2|  AAD-S2-Opt|      AAD-A2|  AAD-A2-Opt|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Avg Time/Iter (ms)   |       10.93|        1.30|        3.11|        1.53|        3.32|        1.66|        3.39|        1.91|        3.54|
| Pure Eval (ms)       |       10.93|        0.08|        0.05|        0.21|        0.09|        0.00|        0.00|        0.01|        0.00|
| Kernel Create (ms)   |           -|        1.20|        3.04|        1.31|        3.20|        1.63|        3.36|        1.87|        3.51|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Speedup vs Bump      |       1.00x|       8.39x|       3.51x|       7.14x|       3.30x|       6.58x|       3.23x|       5.72x|       3.09x|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Expected Exposure    |  2.7678e+04|  2.7678e+04|  2.7678e+04|  2.7678e+04|  2.7678e+04|  2.7678e+04|  2.7678e+04|  2.7678e+04|  2.7678e+04|
| CVA                  |  2.2142e+02|  2.2142e+02|  2.2142e+02|  2.2142e+02|  2.2142e+02|  2.2142e+02|  2.2142e+02|  2.2142e+02|  2.2142e+02|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+


Running Test 4: MC 10 paths...
  Bump-Reval (100 RF)...
  Forward-SSE2-Stab (100 RF)...
  Forward-SSE2-AllOpt (100 RF)...
  Forward-AVX2-Stab (100 RF)...
  Forward-AVX2-AllOpt (100 RF)...
  AAD-SSE2-Stab (100 RF)...
  AAD-SSE2-AllOpt (100 RF)...
  AAD-AVX2-Stab (100 RF)...
  AAD-AVX2-AllOpt (100 RF)...

+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Test 4: MC 10 paths                                                                                                                        |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Config: 1 swap, 3 steps, 10 paths, 100 RF                                                                                                  |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Method               |        Bump|       F-Fwd|   F-Fwd-Opt|   F-Fwd-AVX|F-Fwd-AVX-Opt|      AAD-S2|  AAD-S2-Opt|      AAD-A2|  AAD-A2-Opt|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Avg Time/Iter (ms)   |      112.26|        2.24|        3.65|        3.51|        4.24|        1.84|        3.51|        2.01|        3.71|
| Pure Eval (ms)       |      112.26|        0.89|        0.53|        2.16|        0.94|        0.04|        0.03|        0.02|        0.01|
| Kernel Create (ms)   |           -|        1.33|        3.10|        1.34|        3.29|        1.79|        3.47|        1.96|        3.66|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Speedup vs Bump      |       1.00x|      50.08x|      30.77x|      32.02x|      26.48x|      61.02x|      31.95x|      55.71x|      30.23x|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Expected Exposure    |  3.4645e+04|  3.4645e+04|  3.4645e+04|  3.4645e+04|  3.4645e+04|  3.4645e+04|  3.4645e+04|  3.4645e+04|  3.4645e+04|
| CVA                  |  2.7716e+02|  2.7716e+02|  2.7716e+02|  2.7716e+02|  2.7716e+02|  2.7716e+02|  2.7716e+02|  2.7716e+02|  2.7716e+02|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+


Running Test 5: MC 100 paths...
  Bump-Reval (100 RF)...
  Forward-SSE2-Stab (100 RF)...
  Forward-SSE2-AllOpt (100 RF)...
  Forward-AVX2-Stab (100 RF)...
  Forward-AVX2-AllOpt (100 RF)...
  AAD-SSE2-Stab (100 RF)...
  AAD-SSE2-AllOpt (100 RF)...
  AAD-AVX2-Stab (100 RF)...
  AAD-AVX2-AllOpt (100 RF)...

+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Test 5: MC 100 paths                                                                                                                       |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Config: 1 swap, 3 steps, 100 paths, 100 RF                                                                                                 |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Method               |        Bump|       F-Fwd|   F-Fwd-Opt|   F-Fwd-AVX|F-Fwd-AVX-Opt|      AAD-S2|  AAD-S2-Opt|      AAD-A2|  AAD-A2-Opt|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Avg Time/Iter (ms)   |      741.10|        9.55|        8.30|       20.11|       11.91|        1.97|        3.65|        2.11|        4.17|
| Pure Eval (ms)       |      741.08|        8.28|        5.11|       18.59|        8.65|        0.32|        0.25|        0.15|        0.12|
| Kernel Create (ms)   |           -|        1.25|        3.16|        1.49|        3.24|        1.63|        3.38|        1.90|        3.98|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Speedup vs Bump      |       1.00x|      77.60x|      89.32x|      36.85x|      62.21x|     376.23x|     203.26x|     351.53x|     177.74x|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Expected Exposure    |  3.1850e+04|  3.1850e+04|  3.1850e+04|  3.1850e+04|  3.1850e+04|  3.1850e+04|  3.1850e+04|  3.1850e+04|  3.1850e+04|
| CVA                  |  2.5480e+02|  2.5480e+02|  2.5480e+02|  2.5480e+02|  2.5480e+02|  2.5480e+02|  2.5480e+02|  2.5480e+02|  2.5480e+02|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+


Running Test 6: Full Scale (1000 paths)...
  Bump-Reval (100 RF)...
  Forward-SSE2-Stab (100 RF)...
  Forward-SSE2-AllOpt (100 RF)...
  Forward-AVX2-Stab (100 RF)...
  Forward-AVX2-AllOpt (100 RF)...
  AAD-SSE2-Stab (100 RF)...
  AAD-SSE2-AllOpt (100 RF)...
  AAD-AVX2-Stab (100 RF)...
  AAD-AVX2-AllOpt (100 RF)...

+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Test 6: Full Scale (1000 paths)                                                                                                            |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Config: 1 swap, 3 steps, 1000 paths, 100 RF                                                                                                |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Method               |        Bump|       F-Fwd|   F-Fwd-Opt|   F-Fwd-AVX|F-Fwd-AVX-Opt|      AAD-S2|  AAD-S2-Opt|      AAD-A2|  AAD-A2-Opt|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Avg Time/Iter (ms)   |    10544.75|       86.52|       55.25|      190.18|       94.56|        5.11|        5.99|        3.29|        4.60|
| Pure Eval (ms)       |    10544.66|       84.90|       52.09|      188.51|       91.05|        3.33|        2.55|        1.39|        1.08|
| Kernel Create (ms)   |           -|        1.47|        3.12|        1.57|        3.43|        1.75|        3.40|        1.80|        3.42|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Speedup vs Bump      |       1.00x|     121.88x|     190.87x|      55.45x|     111.52x|    2062.34x|    1760.98x|    3205.48x|    2293.03x|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Expected Exposure    |  3.2617e+04|  3.2631e+04|  3.2631e+04|  3.2631e+04|  3.2631e+04|  3.2631e+04|  3.2631e+04|  3.2631e+04|  3.2631e+04|
| CVA                  |  2.6094e+02|  2.6105e+02|  2.6105e+02|  2.6105e+02|  2.6105e+02|  2.6105e+02|  2.6105e+02|  2.6105e+02|  2.6105e+02|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+

=============================================================
  All benchmarks completed successfully.
  Comprehensive Forge benchmark completed.
=============================================================

=============================================
  Benchmark Complete
=============================================
