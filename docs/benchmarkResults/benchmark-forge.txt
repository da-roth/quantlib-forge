=============================================================
  Comprehensive Forge Benchmark - All Approaches
=============================================================
=============================================================
  XVA Benchmark - QuantLib with Forge (COMPREHENSIVE)
  All approaches: Bump-Reval, Forward-Only, AAD
  SSE2 vs AVX2, Stability vs AllOpt vs NoOpt
=============================================================

  CPU AVX2 Support: YES


Running Test 1: Simple (10 RF)...
  Bump-Reval (10 RF)...
  Forward-SSE2-Stab (10 RF)...
[Forge][Warning] AReal::value() called while Forge recording is active on an active value – this drops you out of the Forge graph (occurrence 1)
[Forge][Warning] AReal::value() called while Forge recording is active on an active value – this drops you out of the Forge graph (occurrence 2)
[Forge][Warning] AReal::value() called while Forge recording is active on an active value – this drops you out of the Forge graph (occurrence 3)
[Forge][Warning] AReal::value() called while Forge recording is active on an active value – this drops you out of the Forge graph (occurrence 4)
[Forge][Warning] AReal::value() called while Forge recording is active on an active value – this drops you out of the Forge graph (occurrence 5)
[Forge][Warning] AReal::value() called while Forge recording is active on an active value – this drops you out of the Forge graph (occurrence 6)
[Forge][Warning] AReal::value() called while Forge recording is active on an active value – this drops you out of the Forge graph (occurrence 7)
[Forge][Warning] AReal::value() called while Forge recording is active on an active value – this drops you out of the Forge graph (occurrence 8)
[Forge][Warning] AReal::value() called while Forge recording is active on an active value – this drops you out of the Forge graph (occurrence 9)
[Forge][Warning] AReal::value() called while Forge recording is active on an active value – this drops you out of the Forge graph (occurrence 10)
  Forward-SSE2-AllOpt (10 RF)...
  Forward-AVX2-Stab (10 RF)...
  Forward-AVX2-AllOpt (10 RF)...
  AAD-SSE2-Stab (10 RF)...
  AAD-SSE2-AllOpt (10 RF)...
  AAD-AVX2-Stab (10 RF)...
  AAD-AVX2-AllOpt (10 RF)...

+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Test 1: Simple (10 RF)                                                                                                                     |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Config: 1 swap, 1 step, 1 path, 10 RF                                                                                                      |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Method               |        Bump|       F-Fwd|   F-Fwd-Opt|   F-Fwd-AVX|F-Fwd-AVX-Opt|      AAD-S2|  AAD-S2-Opt|      AAD-A2|  AAD-A2-Opt|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Total Time (ms)      |        1.97|        1.54|        3.45|        1.68|        3.58|        1.93|        3.72|        2.46|        3.93|
| Pure Eval (ms)       |        0.39|        0.00|        0.00|        0.00|        0.00|        0.00|        0.00|        0.00|        0.00|
| Kernel Create (ms)   |           -|        0.30|        0.69|        0.33|        0.71|        0.38|        0.74|        0.49|        0.78|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Speedup vs Bump      |       1.00x|       1.28x|       0.57x|       1.18x|       0.55x|       1.02x|       0.53x|       0.80x|       0.50x|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Expected Exposure    |  3.7407e+04|  3.7407e+04|  3.7407e+04|  3.7407e+04|  3.7407e+04|  3.7407e+04|  3.7407e+04|  3.7407e+04|  3.7407e+04|
| CVA                  |  2.9926e+02|  2.9926e+02|  2.9926e+02|  2.9926e+02|  2.9926e+02|  2.9926e+02|  2.9926e+02|  2.9926e+02|  2.9926e+02|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+


Running Test 2: Full RF (100 RF)...
  Bump-Reval (100 RF)...
  Forward-SSE2-Stab (100 RF)...
  Forward-SSE2-AllOpt (100 RF)...
  Forward-AVX2-Stab (100 RF)...
  Forward-AVX2-AllOpt (100 RF)...
  AAD-SSE2-Stab (100 RF)...
  AAD-SSE2-AllOpt (100 RF)...
  AAD-AVX2-Stab (100 RF)...
  AAD-AVX2-AllOpt (100 RF)...

+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Test 2: Full RF (100 RF)                                                                                                                   |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Config: 1 swap, 1 step, 1 path, 100 RF                                                                                                     |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Method               |        Bump|       F-Fwd|   F-Fwd-Opt|   F-Fwd-AVX|F-Fwd-AVX-Opt|      AAD-S2|  AAD-S2-Opt|      AAD-A2|  AAD-A2-Opt|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Total Time (ms)      |       22.37|        2.40|        5.30|        2.62|        5.72|        2.82|        6.08|        3.27|        6.34|
| Pure Eval (ms)       |        4.47|        0.03|        0.02|        0.07|        0.03|        0.00|        0.00|        0.00|        0.00|
| Kernel Create (ms)   |           -|        0.45|        1.04|        0.45|        1.11|        0.56|        1.21|        0.65|        1.26|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Speedup vs Bump      |       1.00x|       9.31x|       4.22x|       8.55x|       3.91x|       7.94x|       3.68x|       6.85x|       3.53x|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Expected Exposure    |  4.1649e+04|  4.1649e+04|  4.1649e+04|  4.1649e+04|  4.1649e+04|  4.1649e+04|  4.1649e+04|  4.1649e+04|  4.1649e+04|
| CVA                  |  3.3319e+02|  3.3319e+02|  3.3319e+02|  3.3319e+02|  3.3319e+02|  3.3319e+02|  3.3319e+02|  3.3319e+02|  3.3319e+02|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+


Running Test 3: Time Steps (3 steps)...
  Bump-Reval (100 RF)...
  Forward-SSE2-Stab (100 RF)...
  Forward-SSE2-AllOpt (100 RF)...
  Forward-AVX2-Stab (100 RF)...
  Forward-AVX2-AllOpt (100 RF)...
  AAD-SSE2-Stab (100 RF)...
  AAD-SSE2-AllOpt (100 RF)...
  AAD-AVX2-Stab (100 RF)...
  AAD-AVX2-AllOpt (100 RF)...

+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Test 3: Time Steps (3 steps)                                                                                                               |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Config: 1 swap, 3 steps, 1 path, 100 RF                                                                                                    |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Method               |        Bump|       F-Fwd|   F-Fwd-Opt|   F-Fwd-AVX|F-Fwd-AVX-Opt|      AAD-S2|  AAD-S2-Opt|      AAD-A2|  AAD-A2-Opt|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Total Time (ms)      |       52.91|        6.30|       14.93|        7.21|       15.52|        7.90|       16.01|        8.99|       16.38|
| Pure Eval (ms)       |       10.58|        0.08|        0.05|        0.20|        0.09|        0.00|        0.00|        0.00|        0.00|
| Kernel Create (ms)   |           -|        1.17|        2.92|        1.23|        2.98|        1.55|        3.18|        1.76|        3.25|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Speedup vs Bump      |       1.00x|       8.39x|       3.54x|       7.34x|       3.41x|       6.70x|       3.30x|       5.88x|       3.23x|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Expected Exposure    |  2.7678e+04|  2.7678e+04|  2.7678e+04|  2.7678e+04|  2.7678e+04|  2.7678e+04|  2.7678e+04|  2.7678e+04|  2.7678e+04|
| CVA                  |  2.2142e+02|  2.2142e+02|  2.2142e+02|  2.2142e+02|  2.2142e+02|  2.2142e+02|  2.2142e+02|  2.2142e+02|  2.2142e+02|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+


Running Test 4: MC 10 paths...
  Bump-Reval (100 RF)...
  Forward-SSE2-Stab (100 RF)...
  Forward-SSE2-AllOpt (100 RF)...
  Forward-AVX2-Stab (100 RF)...
  Forward-AVX2-AllOpt (100 RF)...
  AAD-SSE2-Stab (100 RF)...
  AAD-SSE2-AllOpt (100 RF)...
  AAD-AVX2-Stab (100 RF)...
  AAD-AVX2-AllOpt (100 RF)...

+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Test 4: MC 10 paths                                                                                                                        |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Config: 1 swap, 3 steps, 10 paths, 100 RF                                                                                                  |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Method               |        Bump|       F-Fwd|   F-Fwd-Opt|   F-Fwd-AVX|F-Fwd-AVX-Opt|      AAD-S2|  AAD-S2-Opt|      AAD-A2|  AAD-A2-Opt|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Total Time (ms)      |      522.58|       10.11|       16.77|       14.37|       19.24|        7.95|       16.86|        9.37|       16.95|
| Pure Eval (ms)       |      104.51|        0.79|        0.48|        1.58|        0.90|        0.03|        0.03|        0.02|        0.01|
| Kernel Create (ms)   |           -|        1.21|        2.86|        1.29|        2.94|        1.54|        3.33|        1.82|        3.34|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Speedup vs Bump      |       1.00x|      51.70x|      31.16x|      36.36x|      27.17x|      65.73x|      30.99x|      55.79x|      30.84x|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Expected Exposure    |  3.4645e+04|  3.4645e+04|  3.4645e+04|  3.4645e+04|  3.4645e+04|  3.4645e+04|  3.4645e+04|  3.4645e+04|  3.4645e+04|
| CVA                  |  2.7716e+02|  2.7716e+02|  2.7716e+02|  2.7716e+02|  2.7716e+02|  2.7716e+02|  2.7716e+02|  2.7716e+02|  2.7716e+02|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+


Running Test 5: MC 100 paths...
  Bump-Reval (100 RF)...
  Forward-SSE2-Stab (100 RF)...
  Forward-SSE2-AllOpt (100 RF)...
  Forward-AVX2-Stab (100 RF)...
  Forward-AVX2-AllOpt (100 RF)...
  AAD-SSE2-Stab (100 RF)...
  AAD-SSE2-AllOpt (100 RF)...
  AAD-AVX2-Stab (100 RF)...
  AAD-AVX2-AllOpt (100 RF)...

+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Test 5: MC 100 paths                                                                                                                       |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Config: 1 swap, 3 steps, 100 paths, 100 RF                                                                                                 |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Method               |        Bump|       F-Fwd|   F-Fwd-Opt|   F-Fwd-AVX|F-Fwd-AVX-Opt|      AAD-S2|  AAD-S2-Opt|      AAD-A2|  AAD-A2-Opt|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Total Time (ms)      |     5292.45|       47.93|       41.34|       87.57|       61.05|        9.54|       17.89|       10.47|       18.91|
| Pure Eval (ms)       |     1058.48|        8.20|        5.09|       16.07|        8.95|        0.30|        0.30|        0.17|        0.12|
| Kernel Create (ms)   |           -|        1.36|        3.13|        1.41|        3.24|        1.59|        3.25|        1.86|        3.60|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Speedup vs Bump      |       1.00x|     110.42x|     128.03x|      60.43x|      86.69x|     555.05x|     295.83x|     505.63x|     279.82x|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Expected Exposure    |  3.1850e+04|  3.1850e+04|  3.1850e+04|  3.1850e+04|  3.1850e+04|  3.1850e+04|  3.1850e+04|  3.1850e+04|  3.1850e+04|
| CVA                  |  2.5480e+02|  2.5480e+02|  2.5480e+02|  2.5480e+02|  2.5480e+02|  2.5480e+02|  2.5480e+02|  2.5480e+02|  2.5480e+02|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+


Running Test 6: Full Scale (1000 paths)...
  Bump-Reval (100 RF)...
  Forward-SSE2-Stab (100 RF)...
  Forward-SSE2-AllOpt (100 RF)...
  Forward-AVX2-Stab (100 RF)...
  Forward-AVX2-AllOpt (100 RF)...
  AAD-SSE2-Stab (100 RF)...
  AAD-SSE2-AllOpt (100 RF)...
  AAD-AVX2-Stab (100 RF)...
  AAD-AVX2-AllOpt (100 RF)...

+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Test 6: Full Scale (1000 paths)                                                                                                            |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Config: 1 swap, 3 steps, 1000 paths, 100 RF                                                                                                |
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Method               |        Bump|       F-Fwd|   F-Fwd-Opt|   F-Fwd-AVX|F-Fwd-AVX-Opt|      AAD-S2|  AAD-S2-Opt|      AAD-A2|  AAD-A2-Opt|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Total Time (ms)      |    53812.53|      400.74|      257.19|      861.44|      435.02|       24.09|       28.50|       16.70|       22.57|
| Pure Eval (ms)       |    10762.44|       78.47|       48.25|      170.51|       83.64|        3.07|        2.37|        1.44|        1.08|
| Kernel Create (ms)   |           -|        1.58|        3.05|        1.68|        3.30|        1.70|        3.28|        1.76|        3.32|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Speedup vs Bump      |       1.00x|     134.28x|     209.24x|      62.47x|     123.70x|    2233.81x|    1888.09x|    3221.73x|    2384.04x|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+
| Expected Exposure    |  3.2617e+04|  3.2631e+04|  3.2631e+04|  3.2631e+04|  3.2631e+04|  3.2631e+04|  3.2631e+04|  3.2631e+04|  3.2631e+04|
| CVA                  |  2.6094e+02|  2.6105e+02|  2.6105e+02|  2.6105e+02|  2.6105e+02|  2.6105e+02|  2.6105e+02|  2.6105e+02|  2.6105e+02|
+----------------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+

=============================================================
  All benchmarks completed successfully.
  Comprehensive Forge benchmark completed.
=============================================================